È:
@D:\MS-casestudy\Api\ProductApi\Controllers\ProductsController.cs
	namespace 	

ProductApi
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ProductsController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
ProductApiContext *
_context+ 3
;3 4
public 
ProductsController !
(! "
ProductApiContext" 3
context4 ;
); <
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
Product3 :
>: ;
>; <
>< =

GetProduct> H
(H I
)I J
{ 	
if
 
( 
_context 
. 
Product 
== !
null" &
)& '
{
 
return 
NotFound 
( 
) 
;  
}
 
return   
await   
_context   !
.  ! "
Product  " )
.  ) *
ToListAsync  * 5
(  5 6
)  6 7
;  7 8
}!! 	
[$$ 	
HttpGet$$	 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 
async%% 
Task%% 
<%% 
ActionResult%% &
<%%& '
Product%%' .
>%%. /
>%%/ 0

GetProduct%%1 ;
(%%; <
int%%< ?
id%%@ B
)%%B C
{&& 	
if''
 
('' 
_context'' 
.'' 
Product'' 
=='' !
null''" &
)''& '
{((
 
return)) 
NotFound)) 
()) 
))) 
;))  
}**
 
var++ 
product++ 
=++ 
await++ 
_context++  (
.++( )
Product++) 0
.++0 1
	FindAsync++1 :
(++: ;
id++; =
)++= >
;++> ?
if-- 
(-- 
product-- 
==-- 
null-- 
)--  
{.. 
return// 
NotFound// 
(//  
)//  !
;//! "
}00 
return22 
product22 
;22 
}33 	
[77 	
HttpPut77	 
(77 
$str77 
)77 
]77 
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (

PutProduct88) 3
(883 4
int884 7
id888 :
,88: ;
Product88< C
product88D K
)88K L
{99 	
if:: 
(:: 
id:: 
!=:: 
product:: 
.:: 
Id::  
)::  !
{;; 
return<< 

BadRequest<< !
(<<! "
)<<" #
;<<# $
}== 
_context?? 
.?? 
Entry?? 
(?? 
product?? "
)??" #
.??# $
State??$ )
=??* +
EntityState??, 7
.??7 8
Modified??8 @
;??@ A
tryAA 
{BB 
awaitCC 
_contextCC 
.CC 
SaveChangesAsyncCC /
(CC/ 0
)CC0 1
;CC1 2
}DD 
catchEE 
(EE (
DbUpdateConcurrencyExceptionEE /
)EE/ 0
{FF 
ifGG 
(GG 
!GG 
ProductExistsGG "
(GG" #
idGG# %
)GG% &
)GG& '
{HH 
returnII 
NotFoundII #
(II# $
)II$ %
;II% &
}JJ 
elseKK 
{LL 
throwMM 
;MM 
}NN 
}OO 
returnQQ 
	NoContentQQ 
(QQ 
)QQ 
;QQ 
}RR 	
[VV 	
HttpPostVV	 
]VV 
publicWW 
asyncWW 
TaskWW 
<WW 
ActionResultWW &
<WW& '
ProductWW' .
>WW. /
>WW/ 0
PostProductWW1 <
(WW< =
ProductWW= D
productWWE L
)WWL M
{XX 	
ifYY
 
(YY 
_contextYY 
.YY 
ProductYY 
==YY !
nullYY" &
)YY& '
{ZZ
 
return[[ 
Problem[[ 
([[ 
$str[[ O
)[[O P
;[[P Q
}\\
 
_context]] 
.]] 
Product]] 
.]] 
Add]]  
(]]  !
product]]! (
)]]( )
;]]) *
await^^ 
_context^^ 
.^^ 
SaveChangesAsync^^ +
(^^+ ,
)^^, -
;^^- .
return`` 
CreatedAtAction`` "
(``" #
$str``# /
,``/ 0
new``1 4
{``5 6
id``7 9
=``: ;
product``< C
.``C D
Id``D F
}``G H
,``H I
product``J Q
)``Q R
;``R S
}aa 	
[dd 	

HttpDeletedd	 
(dd 
$strdd 
)dd 
]dd 
publicee 
asyncee 
Taskee 
<ee 
IActionResultee '
>ee' (
DeleteProductee) 6
(ee6 7
intee7 :
idee; =
)ee= >
{ff 	
ifgg 
(gg 
_contextgg 
.gg 
Productgg  
==gg! #
nullgg$ (
)gg( )
{hh 
returnii 
NotFoundii 
(ii  
)ii  !
;ii! "
}jj 
varkk 
productkk 
=kk 
awaitkk 
_contextkk  (
.kk( )
Productkk) 0
.kk0 1
	FindAsynckk1 :
(kk: ;
idkk; =
)kk= >
;kk> ?
ifll 
(ll 
productll 
==ll 
nullll 
)ll  
{mm 
returnnn 
NotFoundnn 
(nn  
)nn  !
;nn! "
}oo 
_contextqq 
.qq 
Productqq 
.qq 
Removeqq #
(qq# $
productqq$ +
)qq+ ,
;qq, -
awaitrr 
_contextrr 
.rr 
SaveChangesAsyncrr +
(rr+ ,
)rr, -
;rr- .
returntt 
	NoContenttt 
(tt 
)tt 
;tt 
}uu 	
privateww 
boolww 
ProductExistsww "
(ww" #
intww# &
idww' )
)ww) *
{xx 	
returnyy 
(yy 
_contextyy 
.yy 
Productyy $
?yy$ %
.yy% &
Anyyy& )
(yy) *
eyy* +
=>yy, .
eyy/ 0
.yy0 1
Idyy1 3
==yy4 6
idyy7 9
)yy9 :
)yy: ;
.yy; <
GetValueOrDefaultyy< M
(yyM N
)yyN O
;yyO P
}zz 	
}{{ 
}|| ¸
8D:\MS-casestudy\Api\ProductApi\Data\ProductApiContext.cs
	namespace 	

ProductApi
 
. 
Data 
{		 
public

 

class

 
ProductApiContext

 "
:

# $
	DbContext

% .
{ 
public 
ProductApiContext  
(! "
DbContextOptions" 2
<2 3
ProductApiContext3 D
>D E
optionsF M
)M N
: 
base 
( 
options 
) 
{ 	
} 	
public 
DbSet 
< 

ProductApi 
.  
Models  &
.& '
Product' .
>. /
Product0 7
{8 9
get: =
;= >
set? B
;B C
}D E
=F G
defaultH O
!O P
;P Q
} 
} Œ
DD:\MS-casestudy\Api\ProductApi\Migrations\20220816030145_initial1.cs
	namespace 	

ProductApi
 
. 

Migrations 
{ 
public 

partial 
class 
initial1 !
:" #
	Migration$ -
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
,  
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Category 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
falseU Z
)Z [
,[ \
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= L
,L M
nullableN V
:V W
falseX ]
)] ^
,^ _
Price 
= 
table !
.! "
Column" (
<( )
decimal) 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
nullableI Q
:Q R
falseS X
)X Y
,Y Z
	ImageFile 
= 
table  %
.% &
Column& ,
<, -
string- 3
>3 4
(4 5
type5 9
:9 :
$str; J
,J K
nullableL T
:T U
falseV [
)[ \
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 1
,1 2
x3 4
=>5 7
x8 9
.9 :
Id: <
)< =
;= >
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name   
:   
$str   
)    
;    !
}!! 	
}"" 
}## Ï	
0D:\MS-casestudy\Api\ProductApi\Models\Product.cs
	namespace 	

ProductApi
 
. 
Models 
{ 
public 

class 
Product 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Category 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public		 
decimal		 
Price		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
string

 
?

 
	ImageFile

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
} 
} ’
)D:\MS-casestudy\Api\ProductApi\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddDbContext 
< 
ProductApiContext /
>/ 0
(0 1
options1 8
=>9 ;
options 
. 
UseSqlServer 
( 
builder  
.  !
Configuration! .
.. /
GetConnectionString/ B
(B C
$strC V
)V W
??X Z
throw[ `
newa d%
InvalidOperationExceptione ~
(~ 
$str	 ±
)
± ²
)
² ³
)
³ ´
;
´ µ
builder

 
.

 
Services

 
.

 
AddControllers

 
(

  
)

  !
;

! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddCors 
( 
option 
=>  "
{ 
option 

.
 
AddDefaultPolicy 
( 
builder #
=>$ &
{ 
builder 
. 
AllowAnyOrigin 
( 
)  
.  !
AllowAnyHeader! /
(/ 0
)0 1
.1 2
AllowAnyMethod2 @
(@ A
)A B
;B C
} 
) 
; 
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 

UseRouting 
( 
) 
; 
app   
.   
UseCors   
(   
)   
;   
app!! 
.!! 
UseAuthorization!! 
(!! 
)!! 
;!! 
app## 
.## 
MapControllers## 
(## 
)## 
;## 
app%% 
.%% 
Run%% 
(%% 
)%% 	
;%%	 
